<p><img src="assets/Grove-Servo.png" alt="Servo" width="250" /></p>

<h1 id="servo-motor">Servo Motor</h1>
<p><a href="../../glossary/glossary"><img src="../../glossary/assets/output.png" alt="Output" width="72" /></a> <a href="../../glossary/glossary"><img src="../../glossary/assets/pwm.png" alt="PWM" width="72" /></a></p>

<p>A small motor with position control. Its range of motion is limited to approximately 180°.</p>

<p>Technical information on this component is available <a href="https://wiki.seeedstudio.com/Grove-Servo/">here</a>.</p>

<hr />

<h2 id="background">Background</h2>

<p>The servo motor in the kit is a standard servo motor for hobby applications, meaning it has a range of motion of 180°, as opposed to a continuous servo motor that can move its shaft continuously.</p>

<p>A pulse-width modulated (PWM) signal is used to control its angle. By adjusting the length of the pulse width, you can control the position of the servo motor’s shaft.</p>

<p class="highlight-yellow">To learn more about PWM signals, refer to the <a href="../piezo-buzzer/piezo-buzzer#define-a-tone-using-pulse-width-modulation-pwm">Piezo Buzzer</a> example.</p>

<h2 id="basic-usage">Basic Usage</h2>

<p>This example uses the <code class="language-plaintext highlighter-rouge">adafruit_motor</code> library to control a servo motor connected to pin <strong><code class="language-plaintext highlighter-rouge">D13</code></strong>. A PWM frequency of 50 Hz is standard for driving this type of motor. The <code class="language-plaintext highlighter-rouge">min_pulse</code> and <code class="language-plaintext highlighter-rouge">max_pulse</code> values inform the library of the pulse width it needs to create to move the motor to the minimum (0°) and maximum (180°) positions, respectively.</p>

<p class="note">If your motor does not produce a 180° motion range correctly, you may need to adjust the <code class="language-plaintext highlighter-rouge">min_pulse</code> and <code class="language-plaintext highlighter-rouge">max_pulse</code> values. Be very careful when doing so not to break your motor!</p>

<p>After setting up the servo motor, you can specify the angle you want the motor to move to. It will rotate to the target position at a consistent speed. The main loop in this example iterates through the servo motor’s motion range in increments of 45°.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># --- Imports
</span><span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">board</span>
<span class="kn">import</span> <span class="nn">pwmio</span>
<span class="kn">from</span> <span class="nn">adafruit_motor</span> <span class="kn">import</span> <span class="n">servo</span>

<span class="c1"># --- Variables
</span><span class="n">pwm</span> <span class="o">=</span> <span class="n">pwmio</span><span class="p">.</span><span class="n">PWMOut</span><span class="p">(</span><span class="n">board</span><span class="p">.</span><span class="n">D13</span><span class="p">,</span> <span class="n">frequency</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">servo_motor</span> <span class="o">=</span> <span class="n">servo</span><span class="p">.</span><span class="n">Servo</span><span class="p">(</span><span class="n">pwm</span><span class="p">,</span> <span class="n">min_pulse</span><span class="o">=</span><span class="mi">700</span><span class="p">,</span> <span class="n">max_pulse</span><span class="o">=</span><span class="mi">2600</span><span class="p">)</span>

<span class="c1"># --- Functions
</span>
<span class="c1"># --- Setup
</span>
<span class="c1"># --- Main loop
</span><span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">angle</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">135</span><span class="p">,</span> <span class="mi">180</span><span class="p">]:</span>
        <span class="n">servo_motor</span><span class="p">.</span><span class="n">angle</span> <span class="o">=</span> <span class="n">angle</span>
        <span class="n">time</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></div>

<p class="note">If you define a new position before reaching the previous one, the motor will abort its current operation and directly move to the new position.</p>

<h2 id="servo-sweep-with-speed-control">Servo Sweep with Speed Control</h2>

<p>This tutorial will look at how to control the motion speed and move between two positions more smoothly. To that end, we write a function called <code class="language-plaintext highlighter-rouge">sweep_servo</code> that takes four parameters:</p>

<ul>
  <li>The starting position of the sweep (<code class="language-plaintext highlighter-rouge">start_pos</code>).</li>
  <li>The target position of the sweep (<code class="language-plaintext highlighter-rouge">end_pos</code>).</li>
  <li>The <code class="language-plaintext highlighter-rouge">duration</code> of the sweep.</li>
  <li>The <code class="language-plaintext highlighter-rouge">step_size</code> that divides the range of motion into smaller steps.</li>
</ul>

<p>Based on these parameters, the function calculates a <code class="language-plaintext highlighter-rouge">delay_time</code> between each step. It then moves the motor through the range of angles specified using intermediate steps of the defined <code class="language-plaintext highlighter-rouge">step_size</code>. Each motion step is followed by the calculated delay time that should accumulate to the desired duration over the sweep range.</p>

<p>Before we enter the main loop, we initialize our motor to its 0° position and wait for a second. The main loop then uses our sweep_servo function to sweep back and forth between 0° and 180°.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># --- Imports
</span><span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">board</span>
<span class="kn">import</span> <span class="nn">pwmio</span>
<span class="kn">from</span> <span class="nn">adafruit_motor</span> <span class="kn">import</span> <span class="n">servo</span>

<span class="c1"># --- Variables
</span><span class="n">pwm</span> <span class="o">=</span> <span class="n">pwmio</span><span class="p">.</span><span class="n">PWMOut</span><span class="p">(</span><span class="n">board</span><span class="p">.</span><span class="n">D13</span><span class="p">,</span> <span class="n">frequency</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">servo_motor</span> <span class="o">=</span> <span class="n">servo</span><span class="p">.</span><span class="n">Servo</span><span class="p">(</span><span class="n">pwm</span><span class="p">,</span> <span class="n">min_pulse</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span> <span class="n">max_pulse</span><span class="o">=</span><span class="mi">2600</span><span class="p">)</span>

<span class="c1"># --- Functions
</span><span class="k">def</span> <span class="nf">sweep_servo</span><span class="p">(</span><span class="n">start_pos</span><span class="p">,</span> <span class="n">end_pos</span><span class="p">,</span> <span class="n">duration</span><span class="p">,</span> <span class="n">step_size</span><span class="p">):</span>
    <span class="n">delay_time</span> <span class="o">=</span> <span class="n">duration</span> <span class="o">/</span> <span class="p">((</span><span class="n">end_pos</span> <span class="o">-</span> <span class="n">start_pos</span><span class="p">)</span> <span class="o">/</span> <span class="n">step_size</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">angle</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">start_pos</span><span class="p">,</span> <span class="n">end_pos</span><span class="p">,</span> <span class="n">step_size</span><span class="p">):</span>
        <span class="n">servo_motor</span><span class="p">.</span><span class="n">angle</span> <span class="o">=</span> <span class="n">angle</span>
        <span class="n">time</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">delay_time</span><span class="p">)</span>

<span class="c1"># --- Setup
</span><span class="n">servo_motor</span><span class="p">.</span><span class="n">angle</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">time</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># --- Main loop
</span><span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
    <span class="n">sweep_servo</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    <span class="n">sweep_servo</span><span class="p">(</span><span class="mi">180</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">)</span>
</code></pre></div></div>
